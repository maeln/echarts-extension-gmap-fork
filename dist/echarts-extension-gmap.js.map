{"version":3,"file":"echarts-extension-gmap.js","sources":["../src/helper.js","../src/GMapCoordSys.js","../src/GMapModel.js","../src/GMapView.js","../src/index.js","../index.js"],"sourcesContent":["import { version } from 'echarts/lib/echarts'\n\nexport const ecVer = version.split('.')\n\nexport const isNewEC = ecVer[0] > 4\n\nexport const COMPONENT_TYPE = 'gmap'\n\nexport function v2Equal(a, b) {\n  return a && b && a[0] === b[0] && a[1] === b[1]\n}\n","/* global google */\n\nimport { util as zrUtil, graphic, matrix } from 'echarts/lib/echarts'\nimport { COMPONENT_TYPE } from './helper'\n\nfunction GMapCoordSys(gmap, api) {\n  this._gmap = gmap\n  this.dimensions = ['lng', 'lat']\n  this._mapOffset = [0, 0]\n  this._api = api\n}\n\nconst GMapCoordSysProto = GMapCoordSys.prototype\n\n// exclude private and unsupported options\nconst excludedOptions = [\n  'echartsLayerZIndex',\n  'renderOnMoving'\n]\n\nGMapCoordSysProto.setZoom = function(zoom) {\n  this._zoom = zoom\n}\n\nGMapCoordSysProto.setCenter = function(center) {\n  const latlng = new google.maps.LatLng(center[1], center[0])\n  this._center = latLngToPixel(latlng, this._gmap)\n}\n\nGMapCoordSysProto.setMapOffset = function(mapOffset) {\n  this._mapOffset = mapOffset\n}\n\nGMapCoordSysProto.setGoogleMap = function(gmap) {\n  this._gmap = gmap\n}\n\nGMapCoordSysProto.getGoogleMap = function() {\n  return this._gmap\n}\n\nGMapCoordSysProto.dataToPoint = function(data) {\n  const latlng = new google.maps.LatLng(data[1], data[0])\n  const px = latLngToPixel(latlng, this._gmap)\n  const mapOffset = this._mapOffset\n  return [px.x - mapOffset[0], px.y - mapOffset[1]]\n}\n\nGMapCoordSysProto.pointToData = function(pt) {\n  const mapOffset = this._mapOffset\n  const latlng = pixelToLatLng(\n    new google.maps.Point(pt[0] + mapOffset[0], pt[1] + mapOffset[1]),\n    this._gmap\n  )\n  return [latlng.lng(), latlng.lat()]\n}\n\nGMapCoordSysProto.getViewRect = function() {\n  const api = this._api\n  return new graphic.BoundingRect(0, 0, api.getWidth(), api.getHeight())\n}\n\nGMapCoordSysProto.getRoamTransform = function() {\n  return matrix.create()\n}\n\nGMapCoordSysProto.prepareCustoms = function() {\n  const rect = this.getViewRect()\n  return {\n    coordSys: {\n      type: COMPONENT_TYPE,\n      x: rect.x,\n      y: rect.y,\n      width: rect.width,\n      height: rect.height\n    },\n    api: {\n      coord: zrUtil.bind(this.dataToPoint, this),\n      size: zrUtil.bind(dataToCoordSize, this)\n    }\n  }\n}\n\nfunction dataToCoordSize(dataSize, dataItem) {\n  dataItem = dataItem || [0, 0]\n  return zrUtil.map(\n    [0, 1],\n    function(dimIdx) {\n      const val = dataItem[dimIdx]\n      const halfSize = dataSize[dimIdx] / 2\n      const p1 = []\n      const p2 = []\n      p1[dimIdx] = val - halfSize\n      p2[dimIdx] = val + halfSize\n      p1[1 - dimIdx] = p2[1 - dimIdx] = dataItem[1 - dimIdx]\n      return Math.abs(\n        this.dataToPoint(p1)[dimIdx] - this.dataToPoint(p2)[dimIdx]\n      )\n    },\n    this\n  )\n}\n\n// For deciding which dimensions to use when creating list data\nGMapCoordSys.dimensions = GMapCoordSysProto.dimensions\n\nGMapCoordSys.create = function(ecModel, api) {\n  let gmapCoordSys\n  const root = api.getDom()\n\n  ecModel.eachComponent(COMPONENT_TYPE, function(gmapModel) {\n    const painter = api.getZr().painter\n    const viewportRoot = painter.getViewportRoot()\n    if (typeof google === 'undefined' || !google.maps || !google.maps.Map) {\n      throw new Error('Google Map API is not loaded')\n    }\n    Overlay = Overlay || createOverlayCtor()\n    if (gmapCoordSys) {\n      throw new Error('Only one google map component is allowed')\n    }\n    let gmap = gmapModel.getGoogleMap()\n    if (!gmap) {\n      // Not support IE8\n      const className = 'ec-extension-google-map'\n      let gmapRoot = root.querySelector('.' + className)\n      if (gmapRoot) {\n        // Reset viewport left and top, which will be changed\n        // in moving handler in GMapView\n        viewportRoot.style.left = '0'\n        viewportRoot.style.top = '0'\n        root.removeChild(gmapRoot)\n      }\n      gmapRoot = document.createElement('div')\n      gmapRoot.className = className\n      gmapRoot.style.cssText = 'position:absolute;top:0;left:0;right:0;bottom:0'\n      root.appendChild(gmapRoot)\n\n      const options = zrUtil.clone(gmapModel.get())\n      const echartsLayerZIndex = options.echartsLayerZIndex\n      // delete excluded options\n      zrUtil.each(excludedOptions, function(key) {\n        delete options[key]\n      })\n      const center = options.center\n      // normalize center\n      if (zrUtil.isArray(center)) {\n        options.center = {\n          lng: center[0],\n          lat: center[1]\n        }\n      }\n\n      gmap = new google.maps.Map(gmapRoot, options)\n      gmapModel.setGoogleMap(gmap)\n\n      gmapModel.__projectionChangeListener && gmapModel.__projectionChangeListener.remove()\n      gmapModel.__projectionChangeListener = google.maps.event.addListener(gmap, 'projection_changed',\n        function() {\n          const layer = gmapModel.getEChartsLayer()\n          layer && layer.setMap(null)\n\n          const overlay = new Overlay(viewportRoot, gmap)\n          overlay.setZIndex(echartsLayerZIndex)\n          gmapModel.setEChartsLayer(overlay)\n        }\n      )\n\n      // Override\n      painter.getViewportRootOffset = function() {\n        return { offsetLeft: 0, offsetTop: 0 }\n      }\n    }\n\n    const center = gmapModel.get('center')\n    const normalizedCenter = [\n      center.lng != null ? center.lng : center[0],\n      center.lat != null ? center.lat : center[1]\n    ]\n    const zoom = gmapModel.get('zoom')\n    if (center && zoom) {\n      const gmapCenter = gmap.getCenter()\n      const gmapZoom = gmap.getZoom()\n      const centerOrZoomChanged = gmapModel.centerOrZoomChanged([gmapCenter.lng(), gmapCenter.lat()], gmapZoom)\n      if (centerOrZoomChanged) {\n        const pt = new google.maps.LatLng(normalizedCenter[1], normalizedCenter[0])\n        gmap.setOptions({\n          center: pt,\n          zoom: zoom\n        })\n      }\n    }\n\n    gmapCoordSys = new GMapCoordSys(gmap, api)\n    gmapCoordSys.setMapOffset(gmapModel.__mapOffset || [0, 0])\n    gmapCoordSys.setZoom(zoom)\n    gmapCoordSys.setCenter(normalizedCenter)\n\n    gmapModel.coordinateSystem = gmapCoordSys\n  })\n\n  ecModel.eachSeries(function(seriesModel) {\n    if (seriesModel.get('coordinateSystem') === COMPONENT_TYPE) {\n      seriesModel.coordinateSystem = gmapCoordSys\n    }\n  })\n}\n\nlet Overlay\n\nfunction createOverlayCtor() {\n    function Overlay(root, gmap) {\n      this._root = root\n      this.setMap(gmap)\n    }\n\n    Overlay.prototype = new google.maps.OverlayView()\n\n    Overlay.prototype.onAdd = function() {\n      const gmap = this.getMap()\n      gmap.__overlayProjection = this.getProjection()\n      gmap.getDiv().querySelector('.gm-style > div').appendChild(this._root)\n    }\n\n    /**\n     * @override\n     */\n    Overlay.prototype.draw = function() {\n      google.maps.event.trigger(this.getMap(), 'gmaprender')\n    }\n\n    Overlay.prototype.onRemove = function() {\n      this._root.parentNode.removeChild(this._root)\n      this._root = null\n    }\n\n    Overlay.prototype.setZIndex = function(zIndex) {\n      this._root.style.zIndex = zIndex\n    }\n\n    Overlay.prototype.getZIndex = function() {\n      return this._root.style.zIndex\n    }\n\n    return Overlay\n}\n\nfunction latLngToPixel(latLng, map) {\n  const projection = map.__overlayProjection\n  if (!projection) {\n    return new google.maps.Point(-Infinity, -Infinity)\n  }\n\n  return projection.fromLatLngToContainerPixel(latLng)\n}\n\nfunction pixelToLatLng(pixel, map) {\n  const projection = map.__overlayProjection\n  if (!projection) {\n    return new google.maps.Point(-Infinity, -Infinity)\n  }\n\n  return projection.fromContainerPixelToLatLng(pixel)\n}\n\nGMapCoordSysProto.dimensions = GMapCoordSys.dimensions = ['lng', 'lat']\n\nGMapCoordSysProto.type = COMPONENT_TYPE\n\nexport default GMapCoordSys\n","import { ComponentModel } from 'echarts/lib/echarts'\nimport { COMPONENT_TYPE, isNewEC, v2Equal } from './helper'\n\nconst GMapModel = {\n  type: COMPONENT_TYPE,\n\n  setGoogleMap(gmap) {\n    this.__gmap = gmap\n  },\n\n  getGoogleMap() {\n    // __gmap is set when creating GMapCoordSys\n    return this.__gmap\n  },\n\n  setEChartsLayer(layer) {\n    this.__echartsLayer = layer\n  },\n\n  getEChartsLayer() {\n    return this.__echartsLayer\n  },\n\n  setCenterAndZoom(center, zoom) {\n    this.option.center = center\n    this.option.zoom = zoom\n  },\n\n  centerOrZoomChanged(center, zoom) {\n    const option = this.option\n    return !(v2Equal(center, option.center) && zoom === option.zoom)\n  },\n\n  defaultOption: {\n    center: { lat: 39.90923, lng: 116.397428 },\n    zoom: 5,\n\n    // extension options\n    // since v1.4.0\n    roam: true,\n    echartsLayerZIndex: 2000,\n    renderOnMoving: true\n  }\n}\n\nexport default isNewEC\n  ? ComponentModel.extend(GMapModel)\n  : GMapModel\n","/* global google */\n\nimport { ComponentView, getInstanceByDom, throttle } from 'echarts/lib/echarts'\nimport { isNewEC, COMPONENT_TYPE } from './helper'\n\nconst GMapView = {\n  type: COMPONENT_TYPE,\n\n  render(gmapModel, ecModel, api) {\n    let rendering = true\n\n    const gmap = gmapModel.getGoogleMap()\n    const viewportRoot = api.getZr().painter.getViewportRoot()\n    const coordSys = gmapModel.coordinateSystem\n    const offsetEl = gmap.getDiv()\n    const renderOnMoving = gmapModel.get('renderOnMoving')\n    const oldWidth = offsetEl.clientWidth\n    const oldHeight = offsetEl.clientHeight\n\n    gmap.setOptions({\n      gestureHandling: gmapModel.get('roam') ? 'auto' : 'none'\n    })\n\n    let renderHandler = function() {\n      if (rendering) {\n        return\n      }\n\n      // need resize?\n      const width = offsetEl.clientWidth\n      const height = offsetEl.clientHeight\n      if (width !== oldWidth || height !== oldHeight) {\n        return resizeHandler.call(this)\n      }\n\n      const mapOffset = [\n        -parseInt(offsetEl.style.left, 10) || 0,\n        -parseInt(offsetEl.style.top, 10) || 0\n      ]\n      viewportRoot.style.left = mapOffset[0] + 'px'\n      viewportRoot.style.top = mapOffset[1] + 'px'\n\n      coordSys.setMapOffset(mapOffset)\n      gmapModel.__mapOffset = mapOffset\n\n      api.dispatchAction({\n        type: COMPONENT_TYPE + 'Roam',\n        animation: {\n          // in ECharts 5.x,\n          // we can set animation duration as 0\n          // to ensure no delay when moving or zooming\n          duration: 0\n        }\n      })\n    }\n\n    let resizeHandler = function() {\n      getInstanceByDom(api.getDom()).resize()\n    }\n\n    this._oldRenderHandler && this._oldRenderHandler.remove()\n\n    if (!renderOnMoving) {\n      // TODO hide layer when moving\n      renderHandler = throttle(renderHandler, 100, true)\n      resizeHandler = throttle(resizeHandler, 100, true)\n    }\n\n    this._oldRenderHandler = google.maps.event.addListener(gmap, 'gmaprender', renderHandler)\n\n    rendering = false\n  },\n\n  dispose() {\n    this._oldRenderHandler && this._oldRenderHandler.remove()\n    this._oldRenderHandler = null\n\n    const component = this.__model\n    if (!component) {\n      return\n    }\n\n    const gmapInstance = component.getGoogleMap()\n\n    if (gmapInstance) {\n      // remove injected projection\n      delete gmapInstance.__overlayProjection\n\n      // clear all listeners of map instance\n      google.maps.event.clearInstanceListeners(gmapInstance)\n\n      // remove DOM of map instance\n      const mapDiv = gmapInstance.getDiv()\n      mapDiv.parentNode && mapDiv.parentNode.removeChild(mapDiv)\n    }\n\n    component.setGoogleMap(null)\n    component.setEChartsLayer(null)\n\n    if (component.coordinateSystem) {\n      component.coordinateSystem.setGoogleMap(null)\n      component.coordinateSystem = null\n    }\n  }\n}\n\nexport default isNewEC\n  ? ComponentView.extend(GMapView)\n  : GMapView\n","/**\n * Google Map component extension\n */\n\n import GMapCoordSys from './GMapCoordSys'\n import GMapModel from './GMapModel'\n import GMapView from './GMapView'\n import { isNewEC, ecVer, COMPONENT_TYPE } from './helper'\n\nexport { version, name } from '../package.json';\n\n/**\n * @typedef {import('../export').EChartsExtensionRegisters} EChartsExtensionRegisters\n */\n\n/**\n * Google Map extension installer\n * @param {EChartsExtensionRegisters} registers\n */\n export function install(registers) {\n  // add coordinate system support for pie series for ECharts < 5.4.0\n  if (!isNewEC || (ecVer[0] == 5 && ecVer[1] < 4)) {\n    registers.registerLayout(function(ecModel) {\n      ecModel.eachSeriesByType('pie', function (seriesModel) {\n        const coordSys = seriesModel.coordinateSystem\n        const data = seriesModel.getData()\n        const valueDim = data.mapDimension('value')\n        if (coordSys && coordSys.type === COMPONENT_TYPE) {\n          const center = seriesModel.get('center')\n          const point = coordSys.dataToPoint(center)\n          const cx = point[0]\n          const cy = point[1]\n          data.each(valueDim, function (value, idx) {\n            const layout = data.getItemLayout(idx)\n            layout.cx = cx\n            layout.cy = cy\n          })\n        }\n      })\n    })\n  }\n  // Model\n  isNewEC\n    ? registers.registerComponentModel(GMapModel)\n    : registers.extendComponentModel(GMapModel)\n  // View\n  isNewEC\n    ? registers.registerComponentView(GMapView)\n    : registers.extendComponentView(GMapView)\n  // Coordinate System\n  registers.registerCoordinateSystem(COMPONENT_TYPE, GMapCoordSys)\n  // Action\n  registers.registerAction(\n    {\n      type: COMPONENT_TYPE + 'Roam',\n      event: COMPONENT_TYPE + 'Roam',\n      update: 'updateLayout'\n    },\n    function(payload, ecModel) {\n      ecModel.eachComponent(COMPONENT_TYPE, function(gmapModel) {\n        const gmap = gmapModel.getGoogleMap()\n        const center = gmap.getCenter()\n        gmapModel.setCenterAndZoom([center.lng(), center.lat()], gmap.getZoom())\n      })\n    }\n  )\n}\n","import * as echarts from 'echarts/lib/echarts'\nimport { install } from './src/index'\nimport { isNewEC } from './src/helper'\n\nisNewEC ? echarts.use(install) : install(echarts)\n\nexport { name, version } from './src/index'\n"],"names":["ecVer","version","split","isNewEC","COMPONENT_TYPE","v2Equal","a","b","GMapCoordSys","gmap","api","_gmap","dimensions","_mapOffset","_api","GMapCoordSysProto","prototype","excludedOptions","setZoom","zoom","_zoom","setCenter","center","latlng","google","maps","LatLng","_center","latLngToPixel","setMapOffset","mapOffset","setGoogleMap","getGoogleMap","dataToPoint","data","px","x","y","pointToData","pt","pixelToLatLng","Point","lng","lat","getViewRect","graphic","BoundingRect","getWidth","getHeight","getRoamTransform","matrix","create","prepareCustoms","rect","coordSys","type","width","height","coord","zrUtil","bind","size","dataToCoordSize","dataSize","dataItem","map","dimIdx","val","halfSize","p1","p2","Math","abs","ecModel","gmapCoordSys","root","getDom","eachComponent","gmapModel","painter","getZr","viewportRoot","getViewportRoot","Map","Error","Overlay","createOverlayCtor","className","gmapRoot","querySelector","style","left","top","removeChild","document","createElement","cssText","appendChild","options","clone","get","echartsLayerZIndex","each","key","isArray","__projectionChangeListener","remove","event","addListener","layer","getEChartsLayer","setMap","overlay","setZIndex","setEChartsLayer","getViewportRootOffset","offsetLeft","offsetTop","normalizedCenter","gmapCenter","getCenter","gmapZoom","getZoom","centerOrZoomChanged","setOptions","__mapOffset","coordinateSystem","eachSeries","seriesModel","_root","OverlayView","onAdd","getMap","__overlayProjection","getProjection","getDiv","draw","trigger","onRemove","parentNode","zIndex","getZIndex","latLng","projection","Infinity","fromLatLngToContainerPixel","pixel","fromContainerPixelToLatLng","GMapModel","__gmap","__echartsLayer","setCenterAndZoom","option","defaultOption","roam","renderOnMoving","ComponentModel","extend","GMapView","render","rendering","offsetEl","oldWidth","clientWidth","oldHeight","clientHeight","gestureHandling","renderHandler","resizeHandler","call","parseInt","dispatchAction","animation","duration","getInstanceByDom","resize","_oldRenderHandler","throttle","dispose","component","__model","gmapInstance","clearInstanceListeners","mapDiv","ComponentView","install","registers","registerLayout","eachSeriesByType","getData","valueDim","mapDimension","point","cx","cy","value","idx","layout","getItemLayout","registerComponentModel","extendComponentModel","registerComponentView","extendComponentView","registerCoordinateSystem","registerAction","update","payload","echarts","use"],"mappings":"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"}