!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("echarts")):"function"==typeof define&&define.amd?define(["echarts"],e):"object"==typeof exports?exports.gmap=e(require("echarts")):t.gmap=e(t.echarts)}(window,(function(t){return function(t){var e={};function n(o){if(e[o])return e[o].exports;var r=e[o]={i:o,l:!1,exports:{}};return t[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(o,r,function(e){return t[e]}.bind(null,r));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=4)}([function(e,n){e.exports=t},function(t){t.exports=JSON.parse('{"a":"echarts-extension-gmap","b":"1.0.0"}')},function(t,e,n){(function(e){var n=/^\s+|\s+$/g,o=/^[-+]0x[0-9a-f]+$/i,r=/^0b[01]+$/i,i=/^0o[0-7]+$/i,a=parseInt,s="object"==typeof e&&e&&e.Object===Object&&e,u="object"==typeof self&&self&&self.Object===Object&&self,p=s||u||Function("return this")(),c=Object.prototype.toString,f=Math.max,g=Math.min,l=function(){return p.Date.now()};function m(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function d(t){if("number"==typeof t)return t;if(function(t){return"symbol"==typeof t||function(t){return!!t&&"object"==typeof t}(t)&&"[object Symbol]"==c.call(t)}(t))return NaN;if(m(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=m(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(n,"");var s=r.test(t);return s||i.test(t)?a(t.slice(2),s?2:8):o.test(t)?NaN:+t}t.exports=function(t,e,n){var o,r,i,a,s,u,p=0,c=!1,h=!1,y=!0;if("function"!=typeof t)throw new TypeError("Expected a function");function v(e){var n=o,i=r;return o=r=void 0,p=e,a=t.apply(i,n)}function _(t){return p=t,s=setTimeout(w,e),c?v(t):a}function x(t){var n=t-u;return void 0===u||n>=e||n<0||h&&t-p>=i}function w(){var t=l();if(x(t))return b(t);s=setTimeout(w,function(t){var n=e-(t-u);return h?g(n,i-(t-p)):n}(t))}function b(t){return s=void 0,y&&o?v(t):(o=r=void 0,a)}function L(){var t=l(),n=x(t);if(o=arguments,r=this,u=t,n){if(void 0===s)return _(u);if(h)return s=setTimeout(w,e),v(u)}return void 0===s&&(s=setTimeout(w,e)),a}return e=d(e)||0,m(n)&&(c=!!n.leading,i=(h="maxWait"in n)?f(d(n.maxWait)||0,e):i,y="trailing"in n?!!n.trailing:y),L.cancel=function(){void 0!==s&&clearTimeout(s),p=0,o=u=r=s=void 0},L.flush=function(){return void 0===s?a:b(l())},L}}).call(this,n(3))},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){"use strict";n.r(e),n.d(e,"version",(function(){return o.b})),n.d(e,"name",(function(){return o.a}));var o=n(1),r=n(0);function i(t,e){this._gmap=t,this.dimensions=["lat","lng"],this._mapOffset=[0,0],this._api=e}var a,s=i.prototype,u=["echartsLayerZIndex","renderOnMoving"];function p(t,e){return e=e||[0,0],r.util.map([0,1],(function(n){var o=e[n],r=t[n]/2,i=[],a=[];return i[n]=o-r,a[n]=o+r,i[1-n]=a[1-n]=e[1-n],Math.abs(this.dataToPoint(i)[n]-this.dataToPoint(a)[n])}),this)}function c(){function t(t,e){this._root=t,this.setMap(e)}return t.prototype=new google.maps.OverlayView,t.prototype.onAdd=function(){gmap.getDiv().querySelector(".gm-style > div").appendChild(this._root)},t.prototype.draw=function(){google.maps.event.trigger(this.getMap(),"gmaprender")},t.prototype.onRemove=function(){this._root.parentNode.removeChild(this._root),this._root=null},t.prototype.setZIndex=function(t){this._root.style.zIndex=t},t.prototype.getZIndex=function(){return this._root.style.zIndex},t}function f(t,e){var n=e.getProjection();if(n){var o=e.getBounds(),r=n.fromLatLngToPoint(o.getNorthEast()),i=n.fromLatLngToPoint(o.getSouthWest()),a=Math.pow(2,e.getZoom()),s=n.fromLatLngToPoint(t);return new google.maps.Point((s.x-i.x)*a,(s.y-r.y)*a)}}s.dimensions=["lat","lng"],s.setZoom=function(t){this._zoom=t},s.setCenter=function(t){var e=new google.maps.LatLng(t[0],t[1]);this._center=f(e,this._gmap)},s.setMapOffset=function(t){this._mapOffset=t},s.setGoogleMap=function(t){this._gmap=t},s.getGoogleMap=function(){return this._gmap},s.dataToPoint=function(t){var e=f(new google.maps.LatLng(t[0],t[1]),this._gmap);if(e){var n=this._mapOffset;return[e.x-n[0],e.y-n[1]]}},s.pointToData=function(t){var e=this._mapOffset;!function(t,e){var n=e.getProjection();if(!n)return;var o=Math.pow(2,e.getZoom()),r=e.getBounds(),i=n.fromLatLngToPoint(new google.maps.LatLng(r.getNorthEast().lat(),r.getSouthWest().lng())),a=new google.maps.Point;a.x=t.x/o+i.x,a.y=t.y/o+i.y,n.fromPointToLatLng(a)}(new google.maps.Point(t[0]+e[0],t[1]+e[1]),this._gmap);return[lnglat.lat(),lnglat.lng()]},s.getViewRect=function(){var t=this._api;return new r.graphic.BoundingRect(0,0,t.getWidth(),t.getHeight())},s.getRoamTransform=function(){return r.matrix.create()},s.prepareCustoms=function(t){var e=this.getViewRect();return{coordSys:{type:"gmap",x:e.x,y:e.y,width:e.width,height:e.height},api:{coord:r.util.bind(this.dataToPoint,this),size:r.util.bind(p,this)}}},i.dimensions=s.dimensions,i.create=function(t,e){var n,o=e.getDom();t.eachComponent("gmap",(function(t){var s=e.getZr().painter,p=s.getViewportRoot();if("undefined"==typeof google||void 0===google.maps||void 0===google.maps.Map)throw new Error("It seems that Google Map API has not been loaded completely yet.");if(a=a||c(),n)throw new Error("Only one google map component can exist");var f=t.getGoogleMap();if(!f){var g=o.querySelector(".ec-extension-google-map");g&&(p.style.left="0px",p.style.top="0px",p.style.width="100%",p.style.height="100%",o.removeChild(g)),(g=document.createElement("div")).style.cssText="width:100%;height:100%",g.classList.add("ec-extension-google-map"),o.appendChild(g);var l=r.util.clone(t.get()),m=l.echartsLayerZIndex;r.util.each(u,(function(t){delete l[t]})),l.minZoom=Math.max(l.minZoom||2,2);var d=l.center;r.util.isArray(d)&&(l.center={lng:d[0],lat:d[1]}),f=new google.maps.Map(g,l),t.setGoogleMap(f),t.__projectionChangeListener&&t.__projectionChangeListener.remove(),t.__projectionChangeListener=google.maps.event.addListener(f,"projection_changed",(function(){var e=t.getEChartsLayer();e&&e.setMap(null);var n=new a(p,f);n.setZIndex(m),t.setEChartsLayer(n)})),s.getViewportRootOffset=function(){return{offsetLeft:0,offsetTop:0}}}var h=[null!=(d=t.get("center")).lng?d.lng:d[0],null!=d.lat?d.lat:d[1]],y=t.get("zoom");if(d&&y){var v=f.getCenter(),_=f.getZoom();if(t.centerOrZoomChanged([v.lng(),v.lat()],_)){var x=new google.maps.LatLng(h[1],h[0]);f.setOptions({center:x,zoom:y})}}(n=new i(f,e)).setMapOffset(t.__mapOffset||[0,0]),n.setZoom(y),n.setCenter(h),t.coordinateSystem=n})),t.eachSeries((function(t){"gmap"===t.get("coordinateSystem")&&(t.coordinateSystem=n)}))};var g=i;r.extendComponentModel({type:"gmap",setGoogleMap:function(t){this.__gmap=t},getGoogleMap:function(){return this.__gmap},setEChartsLayer:function(t){this.__echartsLayer=t},getEChartsLayer:function(){return this.__echartsLayer},setCenterAndZoom:function(t,e){this.option.center=t,this.option.zoom=e},centerOrZoomChanged:function(t,e){var n,o,r=this.option;return n=t,o=r.center,!(n&&o&&n[0]===o[0]&&n[1]===o[1]&&e===r.zoom)},defaultOption:{center:{lat:39.90923,lng:116.397428},zoom:5,echartsLayerZIndex:2e3,renderOnMoving:!0}});var l=n(2),m=n.n(l);r.extendComponentView({type:"gmap",render:function(t,e,n){var o=!0,i=t.getGoogleMap(),a=n.getZr().painter.getViewportRoot(),s=t.coordinateSystem,u=i.getDiv(),p=t.get("renderOnMoving"),c=u.clientWidth,f=u.clientHeight,g=function(){if(!o){var e=u.clientWidth,r=u.clientHeight;if(e!==c||r!==f)return l.call(this);var i=[-parseInt(u.style.left,10)||0,-parseInt(u.style.top,10)||0];a.style.left=i[0]+"px",a.style.top=i[1]+"px",s.setMapOffset(i),t.__mapOffset=i,n.dispatchAction({type:"gmapRoam"})}},l=function(){r.getInstanceByDom(n.getDom()).resize()};this._oldRenderHandler&&this._oldRenderHandler.remove(),p||(g=m()(g,100),resizeChart=m()(resizeChart,100)),this._oldRenderHandler=google.maps.event.addListener(i,"gmaprender",g),o=!1},dispose:function(t,e){var n=t.getComponent("gmap"),o=n.getGoogleMap();google.maps.event.clearInstanceListeners(o);var r=o.getDiv();r.parentNode.remove(r),n.setGoogleMap(null),n.setEChartsLayer(null),n.coordinateSystem.setGoogleMap(null)}});r.registerCoordinateSystem("amap",g),r.registerAction({type:"gmapRoam",event:"gmapRoam",update:"updateLayout"},(function(t,e){e.eachComponent("gmap",(function(t){var e=t.getGoogleMap(),n=e.getCenter();t.setCenterAndZoom([n.lng(),n.lat()],e.getZoom())}))}))}])}));
//# sourceMappingURL=echarts-extension-gmap.min.js.map